function mapViewModel(){function e(){s=new google.maps.Map(document.getElementById("map-canvas"),{center:m,mapTypeId:google.maps.MapTypeId.HYBRID}),o(),r();var e=document.getElementById("list");s.controls[google.maps.ControlPosition.LEFT_BOTTOM].push(e);var d=document.getElementById("search-input");s.controls[google.maps.ControlPosition.TOP_LEFT].push(d);var l=new google.maps.places.SearchBox(d);google.maps.event.addListener(l,"places_changed",function(){var e=l.getPlaces();t(),c.allLocations.removeAll();for(var o,i=new google.maps.LatLngBounds,d=0;10>d;d++)void 0!==e[d]&&(o=e[d],n(o),a(o),i.extend(o.geometry.location));s.fitBounds(i),r()}),google.maps.event.addListener(s,"bounds_changed",function(){var e=s.getBounds();l.setBounds(e)});var u=window.setTimeout(i,5e3);google.maps.event.addListener(s,"tilesloaded",function(){window.clearTimeout(u)})}function o(){var e={location:m,radius:800,types:["restaurant","bar","cafe","food"]};l=new google.maps.InfoWindow,d=new google.maps.places.PlacesService(s),d.nearbySearch(e,function(e,o){o==google.maps.places.PlacesServiceStatus.OK&&(bounds=new google.maps.LatLngBounds,e.forEach(function(e){e.marker=a(e),bounds.extend(new google.maps.LatLng(e.geometry.location.lat(),e.geometry.location.lng()))}),s.fitBounds(bounds),e.forEach(n))})}function n(e){var o,n={};n.place_id=e.place_id,n.position=e.geometry.location.toString(),n.name=e.name,void 0!==e.vicinity?o=e.vicinity:void 0!==e.formatted_address&&(o=e.formatted_address),n.address=o,c.allLocations.push(n)}function a(e){var o,n=new google.maps.Marker({map:s,name:e.name.toLowerCase(),position:e.geometry.location,place_id:e.place_id,animation:google.maps.Animation.DROP});void 0!==e.vicinity?o=e.vicinity:void 0!==e.formatted_address&&(o=e.formatted_address);var a='<div style="font-weight: bold">'+e.name+"</div><div>"+o+"</div>"+c.foursquareInfo;return google.maps.event.addListener(n,"click",function(){l.setContent(a),l.open(s,this),s.panTo(n.position)}),p.push(n),n}function t(){for(var e=0;e<p.length;e++)p[e].setMap(null);p.length=0}function i(){$("#map-canvas").html("Whoops, there was an error and it looks like Google Maps didn't load!")}function r(){var e=s.getCenter();u=e.lat(),g=e.lng()}var s,d,l,c=this,u="",g="",m=new google.maps.LatLng(30.311657,-81.691094),p=[];c.allLocations=ko.observableArray([]),c.foursquareInfo="",c.clickMarker=function(e){for(var o,n=0;n<p.length;n++)if(e.place_id===p[n].place_id){o=p[n];break}c.getFoursquareInfo(e),s.panTo(o.position),setTimeout(function(){var n='<div style="font-weight: bold">'+e.name+"</div><div>"+e.address+"</div>"+c.foursquareInfo;l.setContent(n),l.open(s,o)},300)};var v="I3ZHKHFUGCENSSNLNCK0UWXKUXQO4RXSVLC1DE30TBRLKASN",f="GZO1LJTHX23YFLIMFGOLTX1M0GWM21FMH513U2U5N44KC1SZ";this.getFoursquareInfo=function(e){var o="https://api.foursquare.com/v2/venues/search?client_id="+v+"&client_secret="+f+"&v=20150321&ll="+u+","+g+"&query='"+e.name+"'&limit=1";$.getJSON(o).done(function(e){c.foursquareInfo="<p>Foursquare:<br>";var o=e.response.venues[0],n=o.name;c.foursquareInfo+=null!==n&&void 0!==n?"Name: "+n+"<br>":"Name: Not Found";var a=o.contact.formattedPhone;c.foursquareInfo+=null!==a&&void 0!==a?"Phone: "+a+"<br>":"Phone: Not Found";var t=o.contact.twitter;null!==t&&void 0!==t&&(c.foursquareInfo+="twitter: @"+t+"<br>")})},google.maps.event.addDomListener(window,"load",e)}ko.applyBindings(new mapViewModel);